from flask import Flask, request, jsonify
import google.generativeai as genai
import os

app = Flask(__name__)

# ðŸ”‘ Gemini API Key Render Ã¼zerinde Environment Variables kÄ±smÄ±na eklenecek
genai.configure(api_key=os.environ["GEMINI_API_KEY"])

@app.route("/")
def home():
    return "âœ… Gemini Backend Ã‡alÄ±ÅŸÄ±yor!"

@app.route("/solve_text", methods=["POST"])
def solve_text():
    data = request.get_json()
    question = data.get("question", "")

    if not question:
        return jsonify({"error": "Soru boÅŸ olamaz"}), 400

    model = genai.GenerativeModel("gemini-1.5-flash")
    response = model.generate_content(question)

    return jsonify({"answer": response.text})

@app.route("/solve_image", methods=["POST"])
def solve_image():
    # Hem "file" hem de "filename" iÃ§in kontrol yap
    if "file" in request.files:
        file = request.files["file"]
    elif "filename" in request.files:
        file = request.files["filename"]
    else:
        return jsonify({"error": "No file uploaded"}), 400

    # DosyayÄ± iÅŸleme devam et
    content = file.read()
    # buradan sonra Geminiâ€™ye gÃ¶nderme kodun devam edecek...
    return jsonify({"answer": "Dosya alÄ±ndÄ±, boyut: {} byte".format(len(content))})


if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
